<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy Course | ALPHA</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">

    <!-- REPLACE 'test' WITH YOUR REAL PAYPAL CLIENT ID -->
    <!-- Get it from: https://developer.paypal.com/dashboard/ -->
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID_HERE&currency=USD"></script>
    <script src="/static/protection.js"></script>
</head>

<body>

    <div class="container fade-in" style="text-align: center; max-width: 500px;">
        <h1>Unlock Full Access</h1>
        <p style="margin-bottom: 2rem; color: rgba(255,255,255,0.7);">
            Get lifetime access to the Advanced Security Course for just <strong>$50.00</strong>.
        </p>

        <div id="paypal-button-container"></div>

        <div style="margin-top: 2rem;">
            <a href="/home" style="color: rgba(255,255,255,0.5); text-decoration: none;">&larr; Cancel and return
                home</a>
        </div>
    </div>

    <script>
        paypal.Buttons({
            // Set up the transaction
            createOrder: function (data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '50.00'
                        }
                    }]
                });
            },
            // Finalize the transaction
            onApprove: function (data, actions) {
                return actions.order.capture().then(function (details) {
                    // Call your server to save the transaction
                    fetch('/api/confirm-payment', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            orderID: data.orderID,
                            details: details
                        })
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                alert('Transaction completed by ' + details.payer.name.given_name + '!');
                                window.location.href = "/course";
                            } else {
                                alert('Something went wrong on our end.');
                            }
                        });
                });
            }
        }).render('#paypal-button-container');
    </script>
</body>

</html>